/*! * ClamAV NodeJSScanner */ var express = require('express'); var app = express(); var bodyParser = require("body-parser"); var logger = require(appRoot + '/js/util/winstonConfig.js'); var commonConfig = require(appRoot + '/config/commonConfig.json'); var vmProcessoer = require('./vmManager.js'); var viewLocation= appRoot + '/view';var __ = require('underscore');var fs = require('fs');var execFile = require('child_process').execFile;// var logger = require(appRoot + '/js/util/winstonConfig.js');const spawn = require('child_process').spawn;var exec = require('child_process').exec;var libreofficeTreatment = function (scanFiles) {var files = [];var result = [];var scanFiles1 = "\""+scanFiles+"\"";console.log("scan files 1 = "+scanFiles1);var scanFiles2 = scanFiles1.replace(/\[/g,"");var scanFiles3 = scanFiles2.replace(/\]/g,"");var scanFiles4 = scanFiles3.replace(/\"/g,"");var scanFiles = scanFiles4.split(",");console.log("scan files = "+scanFiles);console.log(scanFiles.length);for (var i=0; i < scanFiles.length; i++) {  console.log("file"+i+" = "+scanFiles[i]);if  (scanFiles[i].indexOf(".")>=0){var cmd = 'lowriter --headless --convert-to pdf '+scanFiles[i]+' --outdir /home/TreatAdmin/TreatmentController/pdfs/';console.log("cmd:"+cmd);files.push(cmd);result.push("running:"+cmd);console.log(files);exec(files, function(error, stdout, stderr) {});}else {  var cmd = 'lowriter --headless --convert-to pdf '+scanFiles[i]+'*.* --outdir /home/TreatAdmin/TreatmentController/pdfs/';  files.push(cmd);  result.push("running:"+cmd);  console.log(files);  exec(files, function(error, stdout, stderr) {  });}console.log("finished");}}module.exports = {    getlibreofficeTreatment : libreofficeTreatment};